{% schema %}
{
  "name": "Custom Quiz",
  "settings": [
    {
      "type": "text",
      "id": "quiz_title",
      "label": "Quiz Title",
      "default": "Find Your Perfect Product"
    },
    {
      "type": "text",
      "id": "h2_font_family",
      "label": "Heading Font",
      "default": "black"
    },
    {
      "type": "text",
      "id": "h2_font_size",
      "label": "Heading Font Size",
      "default": "2rem"
    },
    {
      "type": "text",
      "id": "h2_font_color",
      "label": "Heading Font Color",
      "default": "black"
    },
    {
      "type": "text",
      "id": "h2_marg_top",
      "label": "Heading Margin Top",
      "default": "2rem"
    },
    {
      "type": "text",
      "id": "h2_marg_bot",
      "label": "Heading Margin Bottom",
      "default": "2rem"
    },
    {
      "type": "text",
      "id": "quiz_btn",
      "label": "Start Button",
      "default": "Start Quiz"
    },
    {
      "type": "color",
      "id": "quiz_btn_background_color",
      "label": "Start Button Background Color",
      "default": "#0000ff"
    },
    {
      "type": "color",
      "id": "start_btn_text_color",
      "label": "Start Button Text Color",
      "default": "#ffffff"
    },
    {
      "type": "text",
      "id": "start_btn_padding",
      "label": "Start Button Padding",
      "default": "10px 20px"
    },
    {
      "type": "text",
      "id": "start_btn_border_radius",
      "label": "Start Button Border Radius",
      "default": "5px"
    },
    {
      "type": "text",
      "id": "font_family",
      "label": "Start Button Font Family",
      "default": "Arial, sans-serif"
    },
    {
      "type": "color",
      "id": "font_color",
      "label": "Start Button Font Color",
      "default": "#000000"
    },
    {
      "type": "text",
      "id": "font_size",
      "label": "Start Button Font Size",
      "default": "16px"
    },
    {
      "type": "text",
      "id": "question_border_radius",
      "label": "Radios Border Radius",
      "default": "1rem"
    },
    {
      "type": "color",
      "id": "radio_background_color",
      "label": "Radio Background Color",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "radio_border_color",
      "label": "Radio Border Color",
      "default": "#000000"
    },
    {
      "type": "text",
      "id": "radio_size",
      "label": "Radio Size",
      "default": "20px"
    },
    {
      "type": "text",
      "id": "quiz_container_padding",
      "label": "Quiz Container Padding",
      "default": "20px"
    },
    {
      "type": "color",
      "id": "quiz_answer_background_color",
      "label": "Quiz Answer Background Color",
      "default": "#f5f5f5"
    },
    {
      "type": "color",
      "id": "quiz_answer_text_color",
      "label": "Quiz Answer Text Color",
      "default": "#000000"
    },
    {
      "type": "text",
      "id": "quiz_answer_font_size",
      "label": "Quiz Answer Padding",
      "default": "10px 15px"
    },
    {
      "type": "text",
      "id": "quiz_answer_border_radius",
      "label": "Quiz Answer Border Radius",
      "default": "5px"
    },
    {
      "type": "color",
      "id": "prev_btn_background_color",
      "label": "Previous Button Background Color",
      "default": "#cccccc"
    },
    {
      "type": "color",
      "id": "prev_btn_text_color",
      "label": "Previous Button Text Color",
      "default": "#000000"
    },
    {
      "type": "text",
      "id": "prev_btn_padding",
      "label": "Previous Button Padding",
      "default": "10px 20px"
    },
    {
      "type": "text",
      "id": "prev_btn_border_radius",
      "label": "Previous Button Border Radius",
      "default": "5px"
    },
    {
      "type": "text",
      "id": "prev_btn_font_family",
      "label": "Previous Button Font Family",
      "default": "Arial, sans-serif"
    },
    {
      "type": "text",
      "id": "prev_btn_font_size",
      "label": "Previous Button Font Size",
      "default": "16px"
    },
    {
      "type": "color",
      "id": "submit_btn_background_color",
      "label": "Submit Button Background Color",
      "default": "#00ff00"
    },
    {
      "type": "color",
      "id": "submit_btn_text_color",
      "label": "Submit Button Text Color",
      "default": "#ffffff"
    },
    {
      "type": "text",
      "id": "submit_btn_padding",
      "label": "Submit Button Padding",
      "default": "10px 20px"
    },
    {
      "type": "text",
      "id": "submit_btn_border_radius",
      "label": "Submit Button Border Radius",
      "default": "5px"
    },
    {
      "type": "text",
      "id": "submit_btn_font_family",
      "label": "Submit Button Font Family",
      "default": "Arial, sans-serif"
    },
    {
      "type": "text",
      "id": "submit_btn_font_size",
      "label": "Submit Button Font Size",
      "default": "16px"
    },
    {
      "type": "color",
      "id": "reset_btn_background_color",
      "label": "Reset Button Background Color",
      "default": "#ff0000"
    },
    {
      "type": "color",
      "id": "reset_btn_text_color",
      "label": "Reset Button Text Color",
      "default": "#ffffff"
    },
    {
      "type": "text",
      "id": "reset_btn_padding",
      "label": "Reset Button Padding",
      "default": "10px 20px"
    },
    {
      "type": "text",
      "id": "reset_btn_border_radius",
      "label": "Reset Button Border Radius",
      "default": "5px"
    },
    {
      "type": "text",
      "id": "reset_btn_font_family",
      "label": "Reset Button Font Family",
      "default": "Arial, sans-serif"
    },
    {
      "type": "text",
      "id": "reset_btn_font_size",
      "label": "Reset Button Font Size",
      "default": "16px"
    }
  ],
  "blocks": [
    {
      "type": "question",
      "name": "Question",
      "settings": [
        {
          "type": "text",
          "id": "question_text",
          "label": "Question Text"
        },
        {
          "type": "text",
          "id": "answer_1",
          "label": "Answer 1"
        },
        {
          "type": "product_list",
          "id": "recommended_products_1",
          "label": "Recommended Products for Answer 1"
        },
        {
          "type": "text",
          "id": "answer_2",
          "label": "Answer 2"
        },
        {
          "type": "product_list",
          "id": "recommended_products_2",
          "label": "Recommended Products for Answer 2"
        },
        {
          "type": "text",
          "id": "answer_3",
          "label": "Answer 3"
        },
        {
          "type": "product_list",
          "id": "recommended_products_3",
          "label": "Recommended Products for Answer 3"
        },
        {
          "type": "text",
          "id": "answer_4",
          "label": "Answer 4"
        },
        {
          "type": "product_list",
          "id": "recommended_products_4",
          "label": "Recommended Products for Answer 4"
        },
        {
          "type": "text",
          "id": "answer_5",
          "label": "Answer 5"
        },
        {
          "type": "product_list",
          "id": "recommended_products_5",
          "label": "Recommended Products for Answer 5"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Custom Quiz",
      "category": "Custom"
    }
  ]
}
{% endschema %}




<style>
  .quiz-heading {
    font-size: {{ section.settings.h2_font_size }};
    color: {{ section.settings.h2_font_color }};
    margin-top: {{ section.settings.h2_marg_top }};
    margin-bottom: {{ section.settings.h2_marg_bot }};
    font-family: {{ section.settings.h2_font_family }};
  }
  
  .quiz-btn {
    background-color: {{ section.settings.quiz_btn_background_color }};
    color: {{ section.settings.start_btn_text_color }};
    padding: {{ section.settings.start_btn_padding }};
    border-radius: {{ section.settings.start_btn_border_radius }};
    font-family: {{ section.settings.font_family }};
    font-size: {{ section.settings.font_size }};
  }
  
  .question-input {
    border-radius: {{ section.settings.question_border_radius }};
    background-color: {{ section.settings.radio_background_color }};
    border: 1px solid {{ section.settings.radio_border_color }};
    width: {{ section.settings.radio_size }};
    height: {{ section.settings.radio_size }};
  }
  
  .quiz-answer {
    color: {{ section.settings.quiz_answer_text_color }};
    font-szie: {{ section.settings.quiz_answer_font_size }};
    border-radius: {{ section.settings.quiz_answer_border_radius }};
  }

  #prev-question {
    background-color: {{ section.settings.prev_btn_background_color | default: "#cccccc" }};
    color: {{ section.settings.prev_btn_text_color | default: "#000000" }};
    padding: {{ section.settings.prev_btn_padding | default: "10px 20px" }};
    border-radius: {{ section.settings.prev_btn_border_radius | default: "5px" }};
    font-family: {{ section.settings.prev_btn_font_family | default: "Arial, sans-serif" }};
    font-size: {{ section.settings.prev_btn_font_size | default: "16px" }};
  }

  #submit-quiz {
    background-color: {{ section.settings.submit_btn_background_color | default: "#00ff00" }};
    color: {{ section.settings.submit_btn_text_color | default: "#ffffff" }};
    padding: {{ section.settings.submit_btn_padding | default: "10px 20px" }};
    border-radius: {{ section.settings.submit_btn_border_radius | default: "5px" }};
    font-family: {{ section.settings.submit_btn_font_family | default: "Arial, sans-serif" }};
    font-size: {{ section.settings.submit_btn_font_size | default: "16px" }};
  }

  .reset-button {
    background-color: {{ section.settings.reset_btn_background_color | default: "#ff0000" }};
    color: {{ section.settings.reset_btn_text_color | default: "#ffffff" }};
    padding: {{ section.settings.reset_btn_padding | default: "10px 20px" }};
    border-radius: {{ section.settings.reset_btn_border_radius | default: "5px" }};
    font-family: {{ section.settings.reset_btn_font_family | default: "Arial, sans-serif" }};
    font-size: {{ section.settings.reset_btn_font_size | default: "16px" }};
  }
</style>




<div class="quiz-container">
  <h2 class="quiz-heading">{{ section.settings.quiz_title }}</h2>
  <button class="quiz-btn">{{ section.settings.quiz_btn }}</button>
  <div class="quiz-slider">
    {% for block in section.blocks %}
      {% if block.type == 'question' %}
        <div class="quiz-question" data-question-id="{{ forloop.index }}">
          <h3>{{ block.settings.question_text }}</h3>
          <div class="quiz-answers">
            {% assign answers = "dummy, answer_1,answer_2,answer_3,answer_4,answer_5, dummy" | split: ',' %}  
            {% for i in (1..(answers.size - 1)) %}
              {% assign answer_key = answers[i] %}
              {% assign answer = block.settings[answer_key] %}
              {% assign products_key = "recommended_products_" | append: i %}
              {% assign recommended_products_list = block.settings[products_key] | json %}
  
              {% if answer %}
                <script>
                  var answerIndex = "{{ forloop.index }}_{{ i }}";
                  var recommendedProducts = {{ recommended_products_list }};
                  console.log("Answer Group:", answerIndex, "Recommended Products:", recommendedProducts);
                </script>
                <div class="quiz-block">
                  <input 
                    class="question-input {{ block.settings[answer_key] }}" 
                    type="checkbox" 
                    name="question_{{ forloop.index }}" 
                    value="{{ forloop.index }}_{{ i }}" 
                    id="answer_{{ forloop.index }}_{{ i }}" 
                    data-products="{{ recommended_products_list | escape }}">
                  <label class="quiz-answer" for="answer_{{ forloop.index }}_{{ i }}">{{ answer }}</label>
                  <div class="recommended-products" style="display:none;">
                    {% if recommended_products_list.size > 0 %}
                      {% for product in recommended_products_list %}
                        <input type="hidden" class="recommended-product-ids" value="{{ product }}">
                      {% endfor %}
                    {% else %}
                      <p>No products available for this answer.</p>
                    {% endif %}
                  </div>
                </div>
              {% endif %}
            {% endfor %}
          </div>
        </div>
      {% endif %}
    {% endfor %}
  </div>
  <div class="quiz-navigation">
    <button id="prev-question" style="display:none;">Back</button>
    <button id="submit-quiz" style="display:none;">Submit Quiz</button>
  </div>
  <div id="quiz-results" style="display:none;">
    <h3>Recommended Products</h3>
    <div id="recommended-products-container"></div>
  </div>
</div>

