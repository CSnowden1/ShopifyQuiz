{% schema %}
{
  "name": "Custom Quiz",
  "settings": [
    {
      "type": "text",
      "id": "quiz_title",
      "label": "Quiz Title",
      "default": "Find Your Perfect Product"
    },
    {
      "type": "range",
      "id": "h2_font_size",
      "label": "Heading Font Size",
      "min": 1,
      "max": 10,
      "step": 1,
      "unit": "rem",
      "default": 2
    },
    {
      "type": "color",
      "id": "h2_font_color",
      "label": "Heading Font Color",
      "default": "#0000ff"
    },
    {
      "type": "range",
      "id": "h2_marg_vert",
      "label": "Heading Vertical Margin",
      "min": 0,
      "max": 5,
      "step": 1,
      "unit": "rem",
      "default": 2
    },
    {
      "type": "range",
      "id": "h2_marg_hor",
      "label": "Heading Horizontal Margin",
      "min": 0,
      "max": 5,
      "step": 1,
      "unit": "rem",
      "default": 2
    },
    {
      "type": "text",
      "id": "quiz_btn",
      "label": "Start Button Text",
      "default": "Start Quiz"
    },
    {
      "type": "color",
      "id": "quiz_btn_background_color",
      "label": "Start Button Background Color",
      "default": "#0000ff"
    },
    {
      "type": "color",
      "id": "start_btn_text_color",
      "label": "Start Button Text Color",
      "default": "#ffffff"
    },
    {
      "type": "range",
      "id": "start_btn_vert_pad",
      "label": "Start Button Vertical Padding",
      "min": 0,
      "max": 4,
      "step": 1,
      "unit": "rem",
      "default": 1
    },
    {
      "type": "range",
      "id": "start_btn_hor_pad",
      "label": "Start Button Vertical Padding",
      "min": 0,
      "max": 4,
      "step": 1,
      "unit": "rem",
      "default": 1
    },
    {
      "type": "range",
      "id": "start_btn_border_radius",
      "label": "Start Button Border Radius",
      "min": 0,
      "max": 7,
      "step": 1,
      "unit": "rem",
      "default": 2
    },
    {
      "type": "font_picker",
      "id": "font_family",
      "label": "Heading Font",
      "default": "sans-serif"
    },
    {
      "type": "range",
      "id": "button_font_size",
      "label": "Button Font Size",
      "min": 1,
      "max": 7,
      "step": 1,
      "unit": "rem",
      "default": 1
    },
    {
      "type": "range",
      "id": "question_border_radius",
      "label": "Radios Border Radius",
      "min": 0,
      "max": 7,
      "step": 1,
      "unit": "rem",
      "default": 1
    },
    {
      "type": "color",
      "id": "radio_background_color",
      "label": "Radio Background Color",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "radio_border_color",
      "label": "Radio Border Color",
      "default": "#000000"
    },
    {
      "type": "range",
      "id": "radio_size",
      "label": "Radio Size",
      "min": 1,
      "max": 7,
      "step": 1,
      "unit": "rem",
      "default": 2
    },
    {
      "type": "range",
      "id": "quiz_container_padding",
      "label": "Quiz Container Padding",
      "min": 0,
      "max": 7,
      "step": 1,
      "unit": "rem",
      "default": 1
    },
    {
      "type": "color",
      "id": "quiz_answer_background_color",
      "label": "Quiz Answer Background Color",
      "default": "#f5f5f5"
    },
    {
      "type": "color",
      "id": "quiz_answer_text_color",
      "label": "Quiz Answer Text Color",
      "default": "#000000"
    },
    {
      "type": "range",
      "id": "quiz_answer_font_size",
      "label": "Quiz Answer Font Size",
      "min": 1,
      "max": 7,
      "step": 1,
      "unit": "rem",
      "default": 1
    },
    {
      "type": "range",
      "id": "quiz_answer_border_radius",
      "label": "Quiz Answer Border Radius",
      "min": 0,
      "max": 7,
      "step": 1,
      "unit": "rem",
      "default": 1
    },
    {
      "type": "color",
      "id": "prev_btn_background_color",
      "label": "Previous Button Background Color",
      "default": "#cccccc"
    },
    {
      "type": "color",
      "id": "prev_btn_text_color",
      "label": "Previous Button Text Color",
      "default": "#000000"
    },
    {
      "type": "range",
      "id": "prev_btn_padding",
      "label": "Previous Button Padding",
      "min": 0,
      "max": 5,
      "step": 1,
      "unit": "rem",
      "default": 1
    },
    {
      "type": "range",
      "id": "prev_btn_border_radius",
      "label": "Previous Button Border Radius",
      "min": 0,
      "max": 7,
      "step": 1,
      "unit": "rem",
      "default": 1
    },
    {
      "type": "font_picker",
      "id": "prev_btn_font_family",
      "label": "Previous Button Font Family",
      "default": "sans-serif"
    },
    {
      "type": "range",
      "id": "prev_btn_font_size",
      "label": "Previous Button Font Size",
      "min": 1,
      "max": 7,
      "step": 1,
      "unit": "rem",
      "default": 1
    },
    {
      "type": "color",
      "id": "submit_btn_background_color",
      "label": "Submit Button Background Color",
      "default": "#00ff00"
    },
    {
      "type": "color",
      "id": "submit_btn_text_color",
      "label": "Submit Button Text Color",
      "default": "#ffffff"
    },
    {
      "type": "range",
      "id": "submit_btn_padding",
      "label": "Submit Button Padding",
      "min": 0,
      "max": 5,
      "step": 1,
      "unit": "rem",
      "default": 1
    },
    {
      "type": "range",
      "id": "submit_btn_border_radius",
      "label": "Submit Button Border Radius",
      "min": 0,
      "max": 5,
      "step": 1,
      "unit": "rem",
      "default": 1
    },
    {
      "type": "font_picker",
      "id": "submit_btn_font_family",
      "label": "Submit Button Font Family",
      "default": "sans-serif"
    },
    {
      "type": "range",
      "id": "submit_btn_font_size",
      "label": "Submit Button Font Size",
      "min": 1,
      "max": 7,
      "step": 1,
      "unit": "rem",
      "default": 1
    },
    {
      "type": "color",
      "id": "reset_btn_background_color",
      "label": "Reset Button Background Color",
      "default": "#ff0000"
    },
    {
      "type": "color",
      "id": "reset_btn_text_color",
      "label": "Reset Button Text Color",
      "default": "#ffffff"
    },
    {
      "type": "range",
      "id": "reset_btn_padding",
      "label": "Reset Button Padding",
      "min": 0,
      "max": 5,
      "step": 1,
      "unit": "rem",
      "default": 1
    },
    {
      "type": "range",
      "id": "reset_btn_border_radius",
      "label": "Reset Button Border Radius",
      "min": 0,
      "max": 7,
      "step": 1,
      "unit": "rem",
      "default": 1
    },
    {
      "type": "font_picker",
      "id": "reset_btn_font_family",
      "label": "Reset Button Font Family",
      "default": "sans-serif"
    },
    {
      "type": "range",
      "id": "reset_btn_font_size",
      "label": "Reset Button Font Size",
      "min": 1,
      "max": 10,
      "step": 1,
      "unit": "rem",
      "default": 1
    }
  ]
}
{% endschema %}

<style>
/* Container styling */
.custom-quiz-container {
  padding: {{ settings.quiz_container_padding }};
  border-radius: {{ settings.question_border_radius }};
  background-color: {{ settings.quiz_answer_background_color }};
}

/* Heading styling */
.custom-quiz-heading {
  font-family: {{ settings.font_family }};
  font-size: {{ settings.h2_font_size }};
  color: {{ settings.h2_font_color }};
  margin-top: {{ settings.h2_marg_vert }};
  margin-bottom: {{ settings.h2_marg_vert }};
  margin-left: {{ settings.h2_marg_hor }};
  margin-right: {{ settings.h2_marg_hor }};
}

/* Start Button styling */
.quiz-btn {
  background-color: {{ settings.quiz_btn_background_color }};
  color: {{ settings.start_btn_text_color }};
  font-size: {{ settings.button_font_size }};
  padding: {{ settings.start_btn_vert_pad }} {{ settings.start_btn_hor_pad }};
  border-radius: {{ settings.start_btn_border_radius }};
  font-family: {{ settings.font_family }};
}

/* Radio Button styling */
.custom-quiz-radio {
  background-color: {{ settings.radio_background_color }};
  border-color: {{ settings.radio_border_color }};
  width: {{ settings.radio_size }};
  height: {{ settings.radio_size }};
  border-radius: {{ settings.question_border_radius }};
}

/* Quiz Answer styling */
.custom-quiz-answer {
  background-color: {{ settings.quiz_answer_background_color }};
  color: {{ settings.quiz_answer_text_color }};
  font-size: {{ settings.quiz_answer_font_size }};
  border-radius: {{ settings.quiz_answer_border_radius }};
  padding: {{ settings.quiz_container_padding }}; /* Adjust if specific padding for answers is needed */
}

/* Previous Button styling */
.custom-quiz-prev-btn {
  background-color: {{ settings.prev_btn_background_color }};
  color: {{ settings.prev_btn_text_color }};
  font-size: {{ settings.prev_btn_font_size }};
  padding: {{ settings.prev_btn_padding }};
  border-radius: {{ settings.prev_btn_border_radius }};
  font-family: {{ settings.prev_btn_font_family }};
}

/* Submit Button styling */
.custom-quiz-submit-btn {
  background-color: {{ settings.submit_btn_background_color }};
  color: {{ settings.submit_btn_text_color }};
  font-size: {{ settings.submit_btn_font_size }};
  padding: {{ settings.submit_btn_padding }};
  border-radius: {{ settings.submit_btn_border_radius }};
  font-family: {{ settings.submit_btn_font_family }};
}

/* Reset Button styling */
.custom-quiz-reset-btn {
  background-color: {{ settings.reset_btn_background_color }};
  color: {{ settings.reset_btn_text_color }};
  font-size: {{ settings.reset_btn_font_size }};
  padding: {{ settings.reset_btn_padding }};
  border-radius: {{ settings.reset_btn_border_radius }};
  font-family: {{ settings.reset_btn_font_family }};
}

</style>


<div class="quiz-container">
  <h2 class="quiz-heading">{{ section.settings.quiz_title }}</h2>
  <button class="quiz-btn">{{ section.settings.quiz_btn }}</button>
  <div class="quiz-slider">
    {% for block in section.blocks %}
      {% if block.type == 'question' %}
        <div class="quiz-question" data-question-id="{{ forloop.index }}">
          <p>{{ block.settings.question_text }}</p>
          <div class="quiz-answers">
            {% assign answers = "answer_1,answer_2,answer_3,answer_4,answer_5" | split: ',' %}
            <script>
              let listy = '{{ block.settings }}'; 
            </script>
            {% for i in (0..4) %}
              {% assign answer_key = answers[i] %}
              {% assign answer = block.settings[answer_key] %}
              {% assign incremented_i = i | plus: 1 %}
              
              {% assign products_key = "recommended_products_" | append: incremented_i %}

              <script>
                console.log("Product Key", "{{ products_key }}");
              </script>
              {% assign recommended_products_list = block.settings[products_key] | json %}
  
              {% if answer %}
                <script>
                  console.log(listy);
                  var answerIndex = "{{ forloop.index }}_{{ i }}";
                  var recommendedProducts = {{ recommended_products_list }};
                  console.log("Answer Group:", answerIndex, "Recommended Products:", recommendedProducts);
                  console.log("____________________________________________________________________________");
                </script>
                <div class="quiz-block">
                  <input 
                    class="question-input {{ block.settings[answer_key] }}" 
                    type="checkbox" 
                    name="question_{{ forloop.index }}" 
                    value="{{ forloop.index }}_{{ i }}" 
                    id="answer_{{ forloop.index }}_{{ i }}" 
                    data-products="{{ recommended_products_list | escape }}">
                  <label class="quiz-answer" for="answer_{{ forloop.index }}_{{ i }}">{{ answer }}</label>
                  <div class="recommended-products" style="display:none;">
                    {% if recommended_products_list.size > 0 %}
                      {% for product in recommended_products_list %}
                        <input type="hidden" class="recommended-product-ids" value="{{ product }}">
                      {% endfor %}
                    {% else %}
                      <p>No products available for this answer.</p>
                    {% endif %}
                  </div>
                </div>
              {% endif %}
            {% endfor %}
          </div>
        </div>
      {% endif %}
    {% endfor %}
  </div>
  <div class="quiz-navigation">
    <button id="prev-question" style="display:none;">Back</button>
    <button id="submit-quiz" style="display:none;">Submit Quiz</button>
  </div>
  <div id="quiz-results" style="display:none;">
    <h3>Recommended Products</h3>
    <div id="recommended-products-container"></div>
  </div>
</div>


